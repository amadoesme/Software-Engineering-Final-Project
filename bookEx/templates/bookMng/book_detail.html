{% extends "base.html" %}
{% load static %}

{% block sidenav %}
  <li><a href="{% url 'home' %}">Home</a></li>
  <li><a href="{% url 'search' %}">Search</a></li>
  <li><a href="{% url 'cart-view' %}">Cart</a></li>
{% endblock sidenav %}

{% block content %}
  <h1>{{ book.title }}</h1>
  <p><strong>Author:</strong> {{ book.author }}</p>
  <p><strong>ISBN:</strong> {{ book.isbn }}</p>

  <form action="{% url 'cart-add' book.pk %}" method="post" style="margin:10px 0;">
    {% csrf_token %}
    <button type="submit">Add to Cart</button>
  </form>

  <hr>
  <h2>Reviews</h2>
  <p><strong>Average rating:</strong> {{ avg }}</p>

  {% if reviews %}
    <ul>
      {% for r in reviews %}
        <li>
          <strong>{{ r.reviewer_name }}</strong> â€” rated {{ r.rating }} / 5
          <br>{{ r.comment }}
          <br><small>{{ r.created_at }}</small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No reviews yet. Be the first!</p>
  {% endif %}

  <h3>Leave a comment & rating</h3>
  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Submit Review</button>
  </form>
{% endblock content %}
